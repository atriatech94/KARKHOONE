angular.module("myapp").controller("LoginController",function(){}).directive("loginDir",function(){return{link:function(){var e;$(function(){localStorage.getItem("user_id")&&(window.location.hash="#/wall"),$(".english_only").keyup(function(){english_only($(this))}),$("#login_form").on("submit",function(){clearTimeout(e);var t=new Array;if($("#login_form .req").each(function(e,o){(""==$(this).val()||void 0===$(this).val())&&t.push($(this).attr("placeholder"))}),t.length>0)return $("body .alert .msg").text("یک یا چند فیلد خالی است ").parent(".alert").removeClass("none"),e=setTimeout(function(){$("body .alert").addClass("none")},5e3),!1;$("body .lpro").removeClass("none");var o=$("#user").val(),s=$("#pass").val();return $.post(base_url+"api/user_login/Attmi3-HasJ00B3-9854NEsIHY",{user:o,pass:s},function(e,t,o){function s(e){localStorage.setItem("model",device.model),localStorage.setItem("IMEI",e),$.post(base_url+"api/user_imei/Attmi3-HasJ00B3-9854NEsIHY",{user_id:localStorage.getItem("user_id"),model:localStorage.getItem("model"),IMEI:localStorage.getItem("IMEI")})}var l=JSON.parse(e);if("0"==l.msg_code)$("body .lpro").addClass("none"),$("body .alert .msg").text("نام کاربری و رمز عبور اشتباه است").parent(".alert").removeClass("none");else if("2"==l.msg_code)$("body .lpro").addClass("none"),$("body .alert .msg").text("حساب کاربری شما غیرفعال شده است").parent(".alert").removeClass("none");else if("1"==l.msg_code){var a=JSON.stringify(l.user_info),r=JSON.stringify(l.city),i=JSON.stringify(l.state),n=JSON.stringify(l.user_skill),d=JSON.stringify(l.follower),m=JSON.stringify(l.checked),g=JSON.stringify(l.view),u=JSON.stringify(l.info),c=JSON.stringify(l.followers);localStorage.setItem("info",u),localStorage.setItem("followers",c),localStorage.setItem("user_info",a),localStorage.setItem("user_id",l.user_info[0].member_id),(""==localStorage.getItem("reg_id")||null==localStorage.getItem("reg_id"))&&app1.initialize(),localStorage.setItem("city",r),localStorage.setItem("state",i),localStorage.setItem("user_skill",n),localStorage.setItem("user_follower",d),localStorage.setItem("user_checked",m),localStorage.setItem("user_view",g),window.plugins.imeiplugin.getImei(s),$("body .lpro").addClass("none"),init(l.user_info[0].member_id),window.location.hash="#/wall"}}).fail(function(){return $("body .lpro").addClass("none"),$("body .alert .msg").text("خطا در اتصال - مجدد تلاش نمایید ").parent(".alert").removeClass("none"),e=setTimeout(function(){$("body .alert").addClass("none")},5e3),!1}).always(function(t,o){return"timeout"==o?($("body .lpro").addClass("none"),$("body .alert .msg").text("خطا در اتصال - مجدد تلاش نمایید ").parent(".alert").removeClass("none"),e=setTimeout(function(){$("body .alert").addClass("none")},5e3),!1):void 0}),!1})}),$(".show_passwd").click(function(){"password"==$(this).prev("input").attr("type")?($(this).prev("input").attr("type","text"),$(this).addClass("hide_passwd")):($(this).prev("input").attr("type","password"),$(this).removeClass("hide_passwd"))})}}});