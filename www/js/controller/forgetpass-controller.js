angular.module("myapp").controller("ForgetpassController",function(){}).directive("forgetpassDir",function(){return{link:function(){$(function(){$("#forgetpass_form").on("submit",function(){return""==$("#user").val()?($("body .alert .msg").text("فیلد نام کاربری خالی است ").parent(".alert").removeClass("none"),!1):($("body .lpro").removeClass("none"),$.post(base_url+"api/send_user_code/",{user:$("#user").val()},function(e){if(user_data=JSON.parse(e),"0"==user_data.msg_code)return $("body .lpro").addClass("none"),$("body .alert .msg").text("کاربری با این مشخصات در سیستم موجود نمی باشد ").parent(".alert").removeClass("none"),!1;if("1"==user_data.msg_code){$("#forgetpass_form").addClass("none"),$("#reset_pass_form").removeClass("none"),$("body .lpro").addClass("none");var s=" کد بازیابی کلمه ی عبور برای پست الکترونیک و تلفن همراه شما ارسال شد ";localStorage.setItem("users_id",user_data.member_id),$("body .alert .msg").text(s).parent(".alert").removeClass("none")}}).fail(function(){$("body .alert .msg").text("خطا در برقراری اتصال - مجدد تلاش نمایید").parent(".alert").removeClass("none")}),!1)}),$("#reset_pass_form").on("submit",function(){return $("body .lpro").removeClass("none"),""==$("#code").val()?($("body .alert .msg").text("فیلد کد خالی است").parent(".alert").removeClass("none"),!1):($.post(base_url+"api/reset_passwd/Passwd123/",{code:$("#code").val(),user:localStorage.getItem("users_id")},function(e){chech_res=JSON.parse(e),"0"==chech_res.msg_code?($("body .lpro").addClass("none"),$("body .alert .msg").text("کد وارد شده نا معتبر است").parent(".alert").removeClass("none")):"1"==chech_res.msg_code?($("body .lpro").addClass("none"),$("#reset_pass_form").addClass("none"),$("#reset_form").removeClass("none")):"2"==chech_res.msg_code&&($("body .lpro").addClass("none"),$("body .alert .msg").text("اکانت شما به دلیل درخواست متعدد برای بازیابی رمز عبور به مدت 24 ساعت بلاک شده است ").parent(".alert").removeClass("none"))}).fail(function(){$("body .alert .msg").text("خطا در برقراری اتصال - مجدد تلاش نمایید").parent(".alert").removeClass("none")}),!1)}),$("#reset_form").on("submit",function(){var e=$("#pass").val(),s=$("#repass").val();return""==e||""==s||void 0===e||void 0===s?($("body .alert .msg").text("یک یا چند فیلد خالی است").parent(".alert").removeClass("none"),!1):e!=s?($("body .alert .msg").text("کلمه ی عبور و تکرار کلمه ی عبور باید یکسان باشد .").parent(".alert").removeClass("none"),!1):e.length<5?($("body .alert .msg").text("کلمه ی عبور حداقل باید 5 کارکتر باشد .").parent(".alert").removeClass("none"),!1):($("body .lpro").removeClass("none"),$.post(base_url+"api/set_new_passwd/Passwd123/",{new_pass:e,user:localStorage.getItem("users_id")},function(e){$("body .lpro").addClass("none"),$("body .alert .msg").text("رمز عبور شما با موفقیت تغییر پیدا کرد").parent(".alert").removeClass("none"),$("#reset_form").addClass("none"),setTimeout(function(){window.location.hash="#/wall"},5e3)}).fail(function(){$("body .lpro").addClass("none"),$("body .alert .msg").text("عدم برقراری اطلاعات با سرور . مجدد تلاش نمایید .").parent(".alert").removeClass("none")}),!1)}),$(".show_passwd").click(function(){"password"==$(this).prev("input").attr("type")?($(this).prev("input").attr("type","text"),$(this).addClass("hide_passwd")):($(this).prev("input").attr("type","password"),$(this).removeClass("hide_passwd"))})})}}});